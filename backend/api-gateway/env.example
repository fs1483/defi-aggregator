# DeFi聚合器API网关服务环境配置示例
# 复制此文件为.env并根据实际环境配置
# 重要提示：关键配置项从全局配置文件(../../env.global)读取

# ========================================
# 服务配置（从全局配置读取）
# ========================================
# PORT - 从env.global的API_GATEWAY_PORT读取
# APP_ENV - 从env.global读取
# LOG_LEVEL - 从env.global读取
# DEBUG - 从env.global读取

# ========================================
# 安全配置（从全局配置读取）
# ========================================
# JWT_SECRET_KEY - 从env.global读取
# CORS_ALLOWED_ORIGINS - 从env.global读取

# JWT配置（可自定义）
JWT_ALGORITHM=HS256
JWT_ISSUER=defi-aggregator-gateway

# CORS详细配置（可自定义）
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-Request-ID,X-User-Agent
CORS_ALLOW_CREDENTIALS=true
CORS_MAX_AGE=86400

# 受信任的代理（可自定义）
TRUSTED_PROXIES=127.0.0.1,::1

# ========================================
# 后端服务路由配置（从Docker Compose环境变量读取）
# ========================================
# BUSINESS_LOGIC_TARGETS - 由Docker Compose设置
# SMART_ROUTER_TARGETS - 由Docker Compose设置

# API路由配置（可自定义）
API_PREFIX=/api
API_VERSION=v1

# 服务超时配置（可自定义）
BUSINESS_LOGIC_TIMEOUT=30s
BUSINESS_LOGIC_RETRIES=2
SMART_ROUTER_TIMEOUT=10s
SMART_ROUTER_RETRIES=1

# ========================================
# 服务器配置
# ========================================
READ_TIMEOUT=30s
WRITE_TIMEOUT=30s
IDLE_TIMEOUT=120s

# ========================================
# 负载均衡配置
# ========================================
LB_STRATEGY=round_robin
LB_HEALTH_CHECK=true
LB_CHECK_INTERVAL=30s
LB_MAX_RETRIES=3

# 断路器配置
CB_ENABLED=true
CB_FAILURE_THRESHOLD=5
CB_RECOVERY_TIMEOUT=60s
CB_HALF_OPEN_MAX_CALLS=3

# ========================================
# 限流配置
# ========================================
RATE_LIMIT_ENABLED=true
GLOBAL_RATE_REQUESTS=1000
GLOBAL_RATE_DURATION=1m
PER_IP_RATE_REQUESTS=100
PER_IP_RATE_DURATION=1m
RATE_LIMIT_WINDOW=1m

# ========================================
# 监控配置
# ========================================
METRICS_ENABLED=true
METRICS_PATH=/metrics
HEALTH_CHECK_PATH=/health
LOG_REQUESTS=true
LOG_RESPONSES=false
SLOW_REQUEST_MS=1000

# ========================================
# 配置说明
# ========================================
# 1. 本文件定义API网关服务专用配置，全局配置从env.global读取
# 2. 必填配置项：PORT, APP_ENV, LOG_LEVEL, JWT_SECRET_KEY, CORS_ALLOWED_ORIGINS,
#    BUSINESS_LOGIC_TARGETS, SMART_ROUTER_TARGETS
# 3. 后端服务地址由Docker Compose环境变量设置，支持负载均衡
# 4. 生产环境部署时，这些配置由Docker Compose从env.global自动加载
# 5. 如需自定义配置，可在此文件中覆盖全局配置
